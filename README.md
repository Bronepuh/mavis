–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤

Next.js + TypeScript + Ant Design 4.24. –¢–∞–π–º–ª–∞–π–Ω —Å–º–µ–Ω —Å —Ä–µ–∂–∏–º–∞–º–∏ –ü–ª–∞–Ω/–§–∞–∫—Ç, –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π (–æ–ø–æ–∑–¥–∞–Ω–∏–µ, —Ä–∞–Ω–Ω–∏–π —É—Ö–æ–¥, –ø—Ä–æ–≥—É–ª),
—Ñ–∏–ª—å—Ç—Ä–∞–º–∏, —Å–≤–µ—Ç–ª–æ–π/—Ç—ë–º–Ω–æ–π —Ç–µ–º–æ–π –∏ –ª–æ–∫–∞–ª—å—é ru-RU. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ‚Äî Feature-Sliced Design (FSD).

‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

–¢–∞–π–º–ª–∞–π–Ω –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π

–∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Å–µ—Ç–∫–∞ –ø–æ 2 —á–∞—Å–∞;

¬´–ª–∏–ø–∫–∞—è¬ª —à–∫–∞–ª–∞ –≤—Ä–µ–º–µ–Ω–∏;

—Ä–∞–∑–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª–∏ —Å—É—Ç–æ–∫ + –ø–æ–¥–ø–∏—Å–∏ –¥–∞—Ç.

–ü–ª–∞–Ω / –§–∞–∫—Ç

–ø–ª–∞–Ω ‚Äî –∑–∞–ª–∏—Ç–∞—è –ø–ª–∞—à–∫–∞, —Ñ–∞–∫—Ç ‚Äî —à—Ç—Ä–∏—Ö–æ–≤–∫–∞ –ø–æ–≤–µ—Ä—Ö;

–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–¥—Ä–µ–∑–∫–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–∞—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–∞;

–≤ —É–∑–∫–∏—Ö –º–µ—Å—Ç–∞—Ö –ø–ª–∞—à–∫–∏ ¬´—É–º–Ω–µ—é—Ç¬ª: —Å–∫—Ä—ã–≤–∞—é—Ç –ø–æ–¥–ø–∏—Å–∏/–±–µ–π–¥–∂–∏.

–û—Ç–∫–ª–æ–Ω–µ–Ω–∏—è

late ‚Äî –æ–ø–æ–∑–¥–∞–Ω–∏–µ (–∫—Ä–∞—Å–Ω–∞—è ¬´—à–∞–ø–∫–∞¬ª —Å–ª–µ–≤–∞),

early ‚Äî —Ä–∞–Ω–Ω–∏–π —É—Ö–æ–¥ (–æ—Ä–∞–Ω–∂–µ–≤–∞—è ¬´—à–∞–ø–∫–∞¬ª —Å–ø—Ä–∞–≤–∞),

absence ‚Äî –ø—Ä–æ–≥—É–ª (—à—Ç—Ä–∏—Ö-–ø—É–Ω–∫—Ç–∏—Ä–Ω–æ–µ –∫–æ–ª—å—Ü–æ + —á–∏–ø).

–¢–∏–ø—ã –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π –æ—Ñ–æ—Ä–º–ª–µ–Ω—ã enum‚Äô–æ–º DeviationType.

–§–∏–ª—å—Ç—Ä—ã

–ø–æ–∫–∞–∑/—Å–∫—Ä—ã—Ç–∏–µ —Ñ–∞–∫—Ç–∞;

—á–µ–∫–±–æ–∫—Å—ã –ø–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è–º (—Ä–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—ã–π —Ç–∏–ø FiltersState);

–ø—Ä–∏–º–µ—Ä HOC –Ω–∞–¥ Checkbox ‚Äî PersistedCheckbox c —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ LocalStorage (filters:late|early|absence).

–¢–µ–º–∞

–ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Å–≤–µ—Ç–ª–∞—è/—Ç—ë–º–Ω–∞—è;

—Ö—É–∫ useTheme —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—ã–±–æ—Ä –≤ LS (ui-theme) –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç

<link> –Ω–∞ antd.dark.css (–µ—Å—Ç—å —Ñ–æ–ª–ª–±–µ–∫ –Ω–∞ CDN).

–£–ª—É—á—à–µ–Ω–Ω—ã–µ —Å–∫—Ä–æ–ª–ª–±–∞—Ä—ã

–∫—Ä–æ—Å—Å–±—Ä–∞—É–∑–µ—Ä–Ω—ã–µ, ¬´–ø–æ–¥—Ç—è–Ω—É—Ç—ã–µ¬ª —Å—Ç–∏–ª–∏ ‚Äî –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ–≤–µ—Å–∏—Ç—å –∫–ª–∞—Å—Å nice-scroll –Ω–∞ –Ω—É–∂–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.

–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è

ruRU –¥–ª—è AntD + dayjs —Å ru-–ª–æ–∫–∞–ª—å—é.

–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

–º–µ–º–æ–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–æ–∫ —Ç–∞–π–º–ª–∞–π–Ω–∞ (React.memo);

—Ä–µ—ç–∫—Å–ø–æ—Ä—Ç AntD —á–µ—Ä–µ–∑ —Ñ–∞—Å–∞–¥ —Å –∏–º–ø–æ—Ä—Ç–∞–º–∏ –∏–∑ antd/es/\* –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ tree-shaking.

üß± –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (FSD) src/ ‚îú‚îÄ app/ # Next.js App Router ‚îÇ ‚îú‚îÄ layout.tsx # –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏, antd.css ‚îÇ ‚îî‚îÄ page.tsx # —Å–±–æ—Ä–∫–∞ –≤–∏–¥–∂–µ—Ç–∞ ‚îÇ ‚îú‚îÄ
widgets/ ‚îÇ ‚îî‚îÄ schedule/ # –≤–∏–¥–∂–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è ‚îÇ ‚îú‚îÄ ui/ ‚îÇ ‚îÇ ‚îú‚îÄ Schedule.tsx # –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤–∏–¥–∂–µ—Ç–∞ ‚îÇ ‚îÇ ‚îú‚îÄ Timeline.tsx # ¬´–ø–æ–ª–æ—Ç–Ω–æ¬ª —Å —Ä—è–¥–∞–º–∏ ‚îÇ ‚îÇ ‚îî‚îÄ
Row.tsx # –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ —Ç–∞–π–º–ª–∞–π–Ω–∞ ‚îÇ ‚îî‚îÄ timeline.css # —Å—Ç–∏–ª–∏ –≤–∏–¥–∂–µ—Ç–∞ ‚îÇ ‚îú‚îÄ features/ ‚îÇ ‚îî‚îÄ timeline-filters/ ‚îÇ ‚îú‚îÄ ui/Filters.tsx # –ø–∞–Ω–µ–ª—å
—Ñ–∏–ª—å—Ç—Ä–æ–≤ ‚îÇ ‚îî‚îÄ model/types.ts # FiltersState ‚îÇ ‚îú‚îÄ entities/ ‚îÇ ‚îî‚îÄ shift/ ‚îÇ ‚îú‚îÄ model/ ‚îÇ ‚îÇ ‚îú‚îÄ types.ts # ShiftPlan/ShiftFact ‚îÇ ‚îÇ ‚îî‚îÄ
deviation.ts # enum DeviationType, –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ —Ñ–ª–∞–≥–∏ ‚îÇ ‚îî‚îÄ lib/ ‚îÇ ‚îú‚îÄ groupRows.ts # –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–ª–∞–Ω–æ–≤ –ø–æ —Å—Ç—Ä–æ–∫–∞–º ‚îÇ ‚îú‚îÄ buildFactIndex.ts #
–∏–Ω–¥–µ–∫—Å —Ñ–∞–∫—Ç–æ–≤ ‚îÇ ‚îî‚îÄ timeScale.ts # HOUR_MS, COL_HOURS ‚îÇ ‚îú‚îÄ shared/ ‚îÇ ‚îú‚îÄ ui/ ‚îÇ ‚îÇ ‚îú‚îÄ antd.ts # —Ñ–∞—Å–∞–¥-—Ä–µ—ç–∫—Å–ø–æ—Ä—Ç AntD (—Å–º. –Ω–∏–∂–µ) ‚îÇ ‚îÇ ‚îú‚îÄ
PersistedCheckbox.tsx # HOC-–≤–∞—Ä–∏–∞–Ω—Ç —á–µ–∫–±–æ–∫—Å–∞ ‚îÇ ‚îÇ ‚îî‚îÄ timeline/size.ts # –ø—Ä–∞–≤–∏–ª–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ –±–∞—Ä–æ–≤ ‚îÇ ‚îú‚îÄ styles/scrollbars.css # .nice-scroll
—Å—Ç–∏–ª–∏ —Å–∫—Ä–æ–ª–ª–∞ ‚îÇ ‚îú‚îÄ lib/date/getInitialRange.ts# —Å—Ç–∞—Ä—Ç–æ–≤—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω (—Å–µ–≥–æ–¥–Ω—è –∏ 3 –¥–Ω—è –Ω–∞–∑–∞–¥) ‚îÇ ‚îî‚îÄ config/theme/useTheme.ts # –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ
—Ç–µ–º—ã + antd.dark.css ‚îÇ ‚îî‚îÄ public/ ‚îî‚îÄ data/ # –º–æ–∫-–¥–∞–Ω–Ω—ã–µ (plan.json, fact.json)

–ó–∞—á–µ–º —Ä–µ—ç–∫—Å–ø–æ—Ä—Ç AntD?

–§–∞–π–ª src/shared/ui/antd.ts ‚Äî –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –∏–º–ø–æ—Ä—Ç–∞:

–∫—Ä–∞—Å–∏–≤—ã–µ –∏–º–ø–æ—Ä—Ç—ã: import { DatePicker, Tooltip, ruRU, ConfigProvider } from '@/shared/ui/antd';

tree-shaking: –∏–º–ø–æ—Ä—Ç –∏–¥—ë—Ç –∏–∑ antd/es/\*, —Å–±–æ—Ä—â–∏–∫ –Ω–µ –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç —Ü–µ–ª–∏–∫–æ–º antd;

–∏–∑–æ–ª—è—Ü–∏—è –≤–Ω–µ—à–Ω–µ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ ‚Äî –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ –¥—Ä—É–≥—É—é –≤–µ—Ä—Å–∏—é/–±–∏–±–ª–∏–æ—Ç–µ–∫—É –º–µ–Ω—è–µ—Ç—Å—è –æ–¥–∏–Ω —Ñ–∞—Å–∞–¥.

–ü—Ä–∏–º–µ—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ:

// src/shared/ui/antd.ts export { default as ConfigProvider } from 'antd/es/config-provider'; export { default as Space } from
'antd/es/space'; export { default as Tooltip } from 'antd/es/tooltip'; export { default as Divider } from 'antd/es/divider'; export {
default as Tag } from 'antd/es/tag'; export { default as Checkbox } from 'antd/es/checkbox'; export { default as Switch } from
'antd/es/switch'; export { default as DatePicker } from 'antd/es/date-picker'; export { default as ruRU } from 'antd/es/locale/ru_RU';
export { default as Typography } from 'antd/es/typography'; // ‚Ä¶–∏ –ø–æ–¥–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã Typography –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

–í–∞–∂–Ω–æ: –≤ –∫–æ–¥–µ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–µ —Å–º–µ—à–∏–≤–∞–µ–º –∏–º–ø–æ—Ä—Ç—ã –∏–∑ –∫–æ—Ä–Ω—è "antd" –∏ –∏–∑ antd/es/\*. CSS AntD –ø–æ–¥–∫–ª—é—á–∞–µ–º –æ–¥–∏–Ω —Ä–∞–∑ –≤ app/layout.tsx: import
'antd/dist/antd.css'.

–ü—Ä–∏–º–µ—Ä HOC –Ω–∞–¥ Checkbox

PersistedCheckbox –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç, –∫–∞–∫ –ø–æ–¥–∫–ª—é—á–∞—Ç—å HOC, –Ω–µ –ª–æ–º–∞—è –±–∞–∑–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã. –û–±—ã—á–Ω—ã–π Checkbox –æ—Å—Ç–∞—ë—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–º —á–µ—Ä–µ–∑ —Ñ–∞—Å–∞–¥, –∞
HOC-–≤–µ—Ä—Å–∏—è –∂–∏–≤—ë—Ç –æ—Ç–¥–µ–ª—å–Ω–æ:

// src/shared/ui/PersistedCheckbox.tsx import { Checkbox } from '@/shared/ui/antd'; import { withPersistedChecked } from
'@/shared/ui/hoc/withPersistedChecked';

// –¥–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–æ–ø persistKey –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Å localStorage export const PersistedCheckbox = withPersistedChecked(Checkbox);

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ö:

<PersistedCheckbox persistKey="filters:late" checked={deviations.late} onChange={(e) => onChange({ deviations: { ...deviations, late:
e.target.checked } })}

> –û–ø–æ–∑–¥–∞–Ω–∏—è </PersistedCheckbox>

üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

1. –ü—Ä–µ–¥—É—Å–ª–æ–≤–∏—è

Node.js >= 18

–º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–∫–µ—Ç–æ–≤: pnpm / yarn / npm

2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞

# –æ–¥–∏–Ω –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤:

pnpm i

# –∏–ª–∏

yarn

# –∏–ª–∏

npm i

3. –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ pnpm dev # http://localhost:3000

4. –ü—Ä–æ–¥–∞–∫—à–Ω-—Å–±–æ—Ä–∫–∞ pnpm build pnpm start

5. –î–∞–Ω–Ω—ã–µ

–ú–æ–∫–∏ –ª–µ–∂–∞—Ç –≤ public/data (–Ω–∞–ø—Ä–∏–º–µ—Ä, plan.json, fact.json). –ò—Ö –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å, –Ω–µ –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Äî —Ñ—Ä–æ–Ω—Ç —á–∏—Ç–∞–µ—Ç JSON-—Ñ–∞–π–ª—ã –∫–∞–∫ —Å—Ç–∞—Ç–∏–∫—É.

üß© –ö–ª—é—á–µ–≤—ã–µ –∫—É—Å–∫–∏ –î–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é // —Å–µ–≥–æ–¥–Ω—è (endOf('day')) –∏ —Ç—Ä–∏ –¥–Ω—è –Ω–∞–∑–∞–¥ (startOf('day')) getInitialRange(): { fromMs, toMs }

–¢–µ–º–∏–∑–∞—Ü–∏—è

useTheme() —Ö—Ä–∞–Ω–∏—Ç –≤—ã–±–æ—Ä –≤ localStorage("ui-theme"), —Å—Ç–∞–≤–∏—Ç –∞—Ç—Ä–∏–±—É—Ç data-theme, –∏ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç antd.dark.css –∏–∑ /public (–µ—Å–ª–∏ 404 ‚Äî –ø–æ–¥–º–µ–Ω—è–µ—Ç
–Ω–∞ CDN jsDelivr).

–°–∫—Ä–æ–ª–ª–±–∞—Ä—ã

–î–æ–±–∞–≤—å—Ç–µ –∫–ª–∞—Å—Å nice-scroll –Ω–∞ –ª—é–±–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–æ —Å–∫—Ä–æ–ª–ª–æ–º –∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Å—Ç–∏–ª–∏:

<div className="timeline nice-scroll">‚Ä¶</div>

üß≠ –ü—Ä–∞–≤–∏–ª–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–∫–æ—Ä–æ—Ç–∫–æ –ø–æ FSD)

shared ‚Äî –±–∞–∑–æ–≤—ã–µ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤–µ—â–∏ (—É—Ç–∏–ª–∏—Ç—ã, UI, —Å—Ç–∏–ª–∏, –∫–æ–Ω—Ñ–∏–≥).

entities ‚Äî –¥–æ–º–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∏ –∏—Ö –ø—Ä–∏–º–∏—Ç–∏–≤—ã (—Ç–∏–ø ShiftPlan, DeviationType).

features ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏/–∏–Ω—Ç–µ—Ä–∞–∫—Ü–∏–∏ (timeline-filters).

widgets ‚Äî –≥–æ—Ç–æ–≤—ã–µ –±–ª–æ–∫–∏ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü (–≤–∏–¥–∂–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è).

app/pages ‚Äî –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ –∏—Ö –∫–æ–º–ø–æ–∑–∏—Ü–∏—è –∏–∑ –≤–∏–¥–∂–µ—Ç–æ–≤/—Ñ–∏—á.

–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑: app ‚Üí widgets ‚Üí features ‚Üí entities ‚Üí shared. –û–±—Ä–∞—Ç–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –±—ã—Ç—å –Ω–µ –¥–æ–ª–∂–Ω–æ.

üõ†Ô∏è –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã pnpm lint # ESLint pnpm format # Prettier pnpm typecheck # TypeScript

üêû –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

404 –Ω–∞ /antd.dark.css –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Ñ–∞–π–ª –ª–µ–∂–∏—Ç –≤ /public/antd.dark.css. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî —Ö—É–∫ –ø–æ–¥—Ö–≤–∞—Ç–∏—Ç CDN-–≤–µ—Ä—Å–∏—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –î–ª—è –æ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–∞
–ø–æ–ª–æ–∂–∏—Ç–µ —Ñ–∞–π–ª –≤ public.

Tooltip/—Ç–∏–ø–∏–∑–∞—Ü–∏—è AntD –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã AntD –∏–¥—É—Ç —á–µ—Ä–µ–∑ src/shared/ui/antd.ts, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –º–æ–¥—É–ª–∏ –∏–∑ antd/es/\*. –ù–µ —Å–º–µ—à–∏–≤–∞–π—Ç–µ —ç—Ç–æ —Å
import { ‚Ä¶ } from 'antd'.
